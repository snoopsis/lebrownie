{"ast":null,"code":"import _defineProperty from\"/home/snoopsis/nodeSites/lebrownie/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/snoopsis/nodeSites/lebrownie/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/snoopsis/nodeSites/lebrownie/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect}from\"react\";import CarrinhoContext from\"../../context/carrinho/CarrinhoContext\";import AuthContext from\"../../context/auth/authContext\";import PedidosContext from\"../../context/pedidos/PedidosContext\";import AlertContext from\"../../context/alert/alertContext\";import Finalizado from\"./Finalizado\";import axios from\"axios\";var Carrinho=function Carrinho(){// Contexto\nvar carrinhoContext=useContext(CarrinhoContext);var authContext=useContext(AuthContext);var pedidosContext=useContext(PedidosContext);var alertContext=useContext(AlertContext);var setAlert=alertContext.setAlert;var carrinho=carrinhoContext.carrinho,remCart=carrinhoContext.remCart,updateItem=carrinhoContext.updateItem,getCart=carrinhoContext.getCart,remAllCart=carrinhoContext.remAllCart,decreaseItem=carrinhoContext.decreaseItem,addItem=carrinhoContext.addItem;var client=authContext.client,updateClient=authContext.updateClient,loadCliente=authContext.loadCliente;var addPedido=pedidosContext.addPedido,getPedidos=pedidosContext.getPedidos;// # Contexto\n// Ciclo\nuseEffect(function(){if(error.status===404){props.history.push(\"/\");}loadCliente();getCart();getPedidos();// eslint-disable-next-line\n},[]);// # Ciclo\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),finalizado=_useState4[0],setFinalizado=_useState4[1];// Carrinho e Pedido\nvar totalCarrinho=function totalCarrinho(){var valores=carrinho.map(function(i){return i.valor*i.quantidade;});var total=valores.reduce(function(total,numero){return total+numero;},0);return total;};var onChange=function onChange(e){updateClient(_objectSpread(_objectSpread({},client),{},_defineProperty({},e.target.name,e.target.value)));updateItem(_objectSpread(_objectSpread({},carrinho),{},_defineProperty({},e.target.name,e.target.value)));guessPaymentMethod();};var totalProdutos=function totalProdutos(){return carrinho.map(function(produto){return\"\".concat(produto.nome,\" x\").concat(produto.quantidade);});};var pedido={dadosPedido:totalProdutos().toString(),nome:\"\".concat(client.primeiroNome,\" \").concat(client.ultimoNome),email:\"\".concat(client.email),telefone:\"\".concat(client.telefone),endereco:\"Rua \".concat(client.rua,\", \").concat(client.numero,\", \").concat(client.complemento,\", \").concat(client.bairro,\", \").concat(client.cidade,\" - \").concat(client.estado,\" \")};window.Mercadopago.setPublishableKey(\"APP_USR-239a06cd-0a66-4e78-991b-dbb6255d6339\"// \"TEST-f6654274-0c49-4d91-a807-b03070868a4c\"\n);window.Mercadopago.getIdentificationTypes();function guessPaymentMethod(){var cardnum=document.getElementById(\"cardNumber\").value;if(cardnum.length>=6){var bin=cardnum.substring(0,6);window.Mercadopago.getPaymentMethod({bin:bin},setPaymentMethod);}}function setPaymentMethod(status,response){if(status===200){var paymentMethodId=response[0].id;var element=document.getElementById(\"payment_method_id\");element.value=paymentMethodId;getInstallments();}else{alert(\"payment method info error: \".concat(response));}}function getInstallments(){window.Mercadopago.getInstallments({payment_method_id:document.getElementById(\"payment_method_id\").value,amount:parseFloat(document.getElementById(\"transaction_amount\").value)},function(status,response){if(status===200){document.getElementById(\"installments\").options.length=0;response[0].payer_costs.forEach(function(installment){var opt=document.createElement(\"option\");opt.text=installment.recommended_message;opt.value=installment.installments;document.getElementById(\"installments\").appendChild(opt);});}else{alert(\"installments method info error: \".concat(response));}});}function doPay(e){e.preventDefault();var $form=document.querySelector(\"#pay\");window.Mercadopago.createToken($form,sdkResponseHandler);return false;}function sdkResponseHandler(status,response){if(status!==200&&status!==201){alert(\"Dados Incorretos, Confira e Insira Novamente.\");localStorage.setItem(\"cartaoErro\",\"O seu cartao nao foi aceite, nenhuma cobranca sera feita. Tente Novamente.\");window.location.reload();}else{var form=document.querySelector(\"#pay\");var card=document.createElement(\"input\");card.setAttribute(\"name\",\"token\");card.setAttribute(\"type\",\"hidden\");card.setAttribute(\"value\",response.id);form.appendChild(card);window.doSubmit=true;axios({method:\"post\",url:\"/pay\",data:{token:response.id,transaction_amount:totalCarrinho(),installments:document.getElementById(\"installments\").value,payment_method_id:document.getElementById(\"payment_method_id\").value,email:pedido.email,description:pedido.dadosPedido}}).then(function(response){var pag={id:response.data.response.id,status:response.data.response.status};registoPedido(pag);}).catch(function(error){console.log(error);});}}// Finalizar Pedido\nvar onSubmit=function onSubmit(e){e.preventDefault();setLoading(true);// updateDados(client);\ndoPay(e);};var registoPedido=function registoPedido(pag){if(pag.status===\"rejected\"){setAlert(\"O Seu Cartao nao Foi Aceite, Tente Novamente.\",\"danger\");document.getElementById(\"cardNumber\").value=\"\";document.getElementById(\"cardholderName\").value=\"\";document.getElementById(\"cardExpirationMonth\").value=\"\";document.getElementById(\"cardExpirationYear\").value=\"\";document.getElementById(\"securityCode\").value=\"\";document.getElementById(\"docNumber\").value=\"\";// console.log(`Status: ${pag.status}`);\nlocalStorage.setItem(\"cartaoErro\",\"O seu cartao nao foi aceite, nenhuma cobranca sera feita. Tente Novamente.\");setTimeout(function(){return window.location.reload();},6000);}else{addPedido({numero_pedido:pag.id,status_pagamento:pag.status,produtos:pedido.dadosPedido,valor:totalCarrinho(),nome:pedido.nome,endereco:pedido.endereco,contato:pedido.telefone,contato_email:pedido.email});setFinalizado({numero_pedido:pag.id,status_pagamento:pag.status,produtos:pedido.dadosPedido,valor:totalCarrinho(),nome:pedido.nome,endereco:pedido.endereco,contato:pedido.telefone,contato_email:pedido.email});localStorage.removeItem(\"cartaoErro\");remAllCart();}setLoading(false);};var seguirCompra=function seguirCompra(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"pages-title\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Pedido\"),/*#__PURE__*/React.createElement(\"div\",{className:\"line\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"cart\"},carrinho.map(function(i){return/*#__PURE__*/React.createElement(\"div\",{className:\"cart-product first\",key:i.id},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col s4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contents\"},/*#__PURE__*/React.createElement(\"img\",{src:i.img,alt:\"\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col s6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contents\"},/*#__PURE__*/React.createElement(\"strong\",null,i.nome)),/*#__PURE__*/React.createElement(\"div\",{className:\"contents\",style:{marginTop:20}},/*#__PURE__*/React.createElement(\"strong\",null,\" \",i.valor*i.quantidade,\".00\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col s2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contents remove\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-remove\",onClick:function onClick(){return remCart({id:i.id,nome:i.nome,valor:i.valor,img:i.img,desc:i.desc,quantidade:i.quantidade});}})))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col s4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contents\"},/*#__PURE__*/React.createElement(\"p\",null,\"Quantidade\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col s8\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contents\"},/*#__PURE__*/React.createElement(\"button\",{class:\"btn-floating btn-small scale-transition\",style:{backgroundColor:\"#fce4ec\",marginRight:5},onClick:function onClick(){return decreaseItem({id:i.id,nome:i.nome,desc:i.desc,img:i.img,valor:i.valor,quantidade:i.quantidade});}},/*#__PURE__*/React.createElement(\"i\",{class:\"material-icons\",style:{color:\"#000\"}},\"remove\")),/*#__PURE__*/React.createElement(\"input\",{name:\"quantidade\",type:\"number\",readOnly:true,style:{width:30,textAlign:\"center\"},value:i.quantidade}),/*#__PURE__*/React.createElement(\"button\",{class:\"btn-floating btn-small scale-transition\",style:{backgroundColor:\"#fce4ec\",marginLeft:5},onClick:function onClick(){return addItem({id:i.id,nome:i.nome,desc:i.desc,img:i.img,valor:i.valor,quantidade:i.quantidade});}},/*#__PURE__*/React.createElement(\"i\",{class:\"material-icons\",style:{color:\"#000\"}},\"add\"))))));})),/*#__PURE__*/React.createElement(\"div\",{className:\"total-pay\"},carrinho.map(function(i){return/*#__PURE__*/React.createElement(\"div\",{className:\"row\",key:i.id},/*#__PURE__*/React.createElement(\"div\",{className:\"col s8\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contents\"},/*#__PURE__*/React.createElement(\"p\",null,i.nome))),/*#__PURE__*/React.createElement(\"div\",{className:\"col s4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contents right\"},/*#__PURE__*/React.createElement(\"p\",null,i.valor*i.quantidade,\".00\"))));}),/*#__PURE__*/React.createElement(\"div\",{className:\"col s8\",style:{marginBottom:10}},/*#__PURE__*/React.createElement(\"div\",{className:\"contents\"},/*#__PURE__*/React.createElement(\"h5\",null,\"Total\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col s4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contents right\"},/*#__PURE__*/React.createElement(\"h5\",null,totalCarrinho(),\".00\"))),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null)),/*#__PURE__*/React.createElement(\"form\",{onSubmit:onSubmit,id:\"pay\",name:\"pay\"},/*#__PURE__*/React.createElement(\"div\",{className:\"pages-title\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Dados para Entrega\"),/*#__PURE__*/React.createElement(\"div\",{className:\"line\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"signup-contents\"},/*#__PURE__*/React.createElement(\"label\",null,\"Celular\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"telefone\",value:client.telefone,required:true,onChange:onChange}),/*#__PURE__*/React.createElement(\"label\",null,\"Rua\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"rua\",value:client.rua,required:true,onChange:onChange}),/*#__PURE__*/React.createElement(\"label\",null,\"Numero\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"numero\",value:client.numero,required:true,onChange:onChange}),/*#__PURE__*/React.createElement(\"label\",null,\"Complemento\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"complemento\",value:client.complemento,required:true,onChange:onChange}),/*#__PURE__*/React.createElement(\"label\",null,\"Bairro\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"numero\",value:client.bairro,required:true,onChange:onChange}),/*#__PURE__*/React.createElement(\"label\",null,\"Cidade\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"cidade\",value:client.cidade,required:true,onChange:onChange}),/*#__PURE__*/React.createElement(\"label\",null,\"Estado\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"numero\",value:client.estado,required:true,onChange:onChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"pages-title\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Pagamento\"),/*#__PURE__*/React.createElement(\"div\",{className:\"line\"}),/*#__PURE__*/React.createElement(\"p\",null,localStorage.getItem(\"cartaoErro\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"signup-contents\"},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"input\",{type:\"hidden\",id:\"description\",value:totalProdutos(),onChange:onChange})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"input\",{id:\"transaction_amount\",value:pedido.dadosPedido,type:\"hidden\",onChange:onChange})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"cardNumber\"},\"N\\xFAmero do cart\\xE3o\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"cardNumber\",\"data-checkout\":\"cardNumber\",onChange:onChange,required:true})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"cardholderName\"},\"Nome Igual ao Cartao\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"cardholderName\",\"data-checkout\":\"cardholderName\",onChange:onChange,required:true})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"cardExpirationMonth\"},\"M\\xEAs de vencimento\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"cardExpirationMonth\",\"data-checkout\":\"cardExpirationMonth\",onChange:onChange,required:true})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"cardExpirationYear\"},\"Ano de vencimento\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"cardExpirationYear\",\"data-checkout\":\"cardExpirationYear\",onChange:onChange,required:true})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"securityCode\"},\"C\\xF3digo de seguran\\xE7a\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"securityCode\",\"data-checkout\":\"securityCode\",onChange:onChange,required:true})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"select\",{type:\"hidden\",id:\"installments\",className:\"form-control\",onChange:onChange})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"select\",{id:\"docType\",\"data-checkout\":\"docType\",type:\"hidden\"})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"docNumber\"},\"CPF\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"docNumber\",\"data-checkout\":\"docNumber\",required:true})),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"input\",{type:\"hidden\",id:\"email\",value:pedido.email,onChange:onChange})),/*#__PURE__*/React.createElement(\"input\",{type:\"hidden\",id:\"payment_method_id\",onChange:onChange}),!loading&&/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-send\"}),\"Fazer Pedido\"),loading&&/*#__PURE__*/React.createElement(\"button\",{className:\"button\"},\"Aguarde...\"))));};return/*#__PURE__*/React.createElement(React.Fragment,null,finalizado&&/*#__PURE__*/React.createElement(Finalizado,{pedido:finalizado}),/*#__PURE__*/React.createElement(\"div\",{className:\"segments-page\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},carrinho.length>0&&seguirCompra())));};export default Carrinho;","map":{"version":3,"sources":["/home/snoopsis/nodeSites/lebrownie/client/src/components/views/Carrinho.js"],"names":["React","useContext","useState","useEffect","CarrinhoContext","AuthContext","PedidosContext","AlertContext","Finalizado","axios","Carrinho","carrinhoContext","authContext","pedidosContext","alertContext","setAlert","carrinho","remCart","updateItem","getCart","remAllCart","decreaseItem","addItem","client","updateClient","loadCliente","addPedido","getPedidos","error","status","props","history","push","loading","setLoading","finalizado","setFinalizado","totalCarrinho","valores","map","i","valor","quantidade","total","reduce","numero","onChange","e","target","name","value","guessPaymentMethod","totalProdutos","produto","nome","pedido","dadosPedido","toString","primeiroNome","ultimoNome","email","telefone","endereco","rua","complemento","bairro","cidade","estado","window","Mercadopago","setPublishableKey","getIdentificationTypes","cardnum","document","getElementById","length","bin","substring","getPaymentMethod","setPaymentMethod","response","paymentMethodId","id","element","getInstallments","alert","payment_method_id","amount","parseFloat","options","payer_costs","forEach","installment","opt","createElement","text","recommended_message","installments","appendChild","doPay","preventDefault","$form","querySelector","createToken","sdkResponseHandler","localStorage","setItem","location","reload","form","card","setAttribute","doSubmit","method","url","data","token","transaction_amount","description","then","pag","registoPedido","catch","console","log","onSubmit","setTimeout","numero_pedido","status_pagamento","produtos","contato","contato_email","removeItem","seguirCompra","img","marginTop","desc","backgroundColor","marginRight","color","width","textAlign","marginLeft","marginBottom","getItem"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from \"react\";\r\nimport CarrinhoContext from \"../../context/carrinho/CarrinhoContext\";\r\nimport AuthContext from \"../../context/auth/authContext\";\r\nimport PedidosContext from \"../../context/pedidos/PedidosContext\";\r\nimport AlertContext from \"../../context/alert/alertContext\";\r\nimport Finalizado from \"./Finalizado\";\r\nimport axios from \"axios\";\r\n\r\nconst Carrinho = () => {\r\n  // Contexto\r\n  const carrinhoContext = useContext(CarrinhoContext);\r\n  const authContext = useContext(AuthContext);\r\n  const pedidosContext = useContext(PedidosContext);\r\n  const alertContext = useContext(AlertContext);\r\n\r\n  const { setAlert } = alertContext;\r\n  const {\r\n    carrinho,\r\n    remCart,\r\n    updateItem,\r\n    getCart,\r\n    remAllCart,\r\n    decreaseItem,\r\n    addItem\r\n  } = carrinhoContext;\r\n  const { client, updateClient, loadCliente } = authContext;\r\n  const { addPedido, getPedidos } = pedidosContext;\r\n  // # Contexto\r\n\r\n  // Ciclo\r\n  useEffect(() => {\r\n    if (error.status === 404) {\r\n      props.history.push(\"/\");\r\n    }\r\n    loadCliente();\r\n    getCart();\r\n    getPedidos();\r\n    // eslint-disable-next-line\r\n  }, []);\r\n  // # Ciclo\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [finalizado, setFinalizado] = useState();\r\n\r\n  // Carrinho e Pedido\r\n  const totalCarrinho = () => {\r\n    const valores = carrinho.map(i => i.valor * i.quantidade);\r\n    var total = valores.reduce((total, numero) => total + numero, 0);\r\n    return total;\r\n  };\r\n\r\n  const onChange = e => {\r\n    updateClient({ ...client, [e.target.name]: e.target.value });\r\n    updateItem({ ...carrinho, [e.target.name]: e.target.value });\r\n    guessPaymentMethod();\r\n  };\r\n\r\n  const totalProdutos = () => {\r\n    return carrinho.map(produto => `${produto.nome} x${produto.quantidade}`);\r\n  };\r\n\r\n  const pedido = {\r\n    dadosPedido: totalProdutos().toString(),\r\n    nome: `${client.primeiroNome} ${client.ultimoNome}`,\r\n    email: `${client.email}`,\r\n    telefone: `${client.telefone}`,\r\n    endereco: `Rua ${client.rua}, ${client.numero}, ${client.complemento}, ${client.bairro}, ${client.cidade} - ${client.estado} `\r\n  };\r\n\r\n  window.Mercadopago.setPublishableKey(\r\n    \"APP_USR-239a06cd-0a66-4e78-991b-dbb6255d6339\"\r\n    // \"TEST-f6654274-0c49-4d91-a807-b03070868a4c\"\r\n  );\r\n\r\n  window.Mercadopago.getIdentificationTypes();\r\n\r\n  function guessPaymentMethod() {\r\n    let cardnum = document.getElementById(\"cardNumber\").value;\r\n    if (cardnum.length >= 6) {\r\n      let bin = cardnum.substring(0, 6);\r\n      window.Mercadopago.getPaymentMethod(\r\n        {\r\n          bin: bin\r\n        },\r\n        setPaymentMethod\r\n      );\r\n    }\r\n  }\r\n\r\n  function setPaymentMethod(status, response) {\r\n    if (status === 200) {\r\n      let paymentMethodId = response[0].id;\r\n      let element = document.getElementById(\"payment_method_id\");\r\n      element.value = paymentMethodId;\r\n      getInstallments();\r\n    } else {\r\n      alert(`payment method info error: ${response}`);\r\n    }\r\n  }\r\n\r\n  function getInstallments() {\r\n    window.Mercadopago.getInstallments(\r\n      {\r\n        payment_method_id: document.getElementById(\"payment_method_id\").value,\r\n        amount: parseFloat(document.getElementById(\"transaction_amount\").value)\r\n      },\r\n      function(status, response) {\r\n        if (status === 200) {\r\n          document.getElementById(\"installments\").options.length = 0;\r\n          response[0].payer_costs.forEach(installment => {\r\n            let opt = document.createElement(\"option\");\r\n            opt.text = installment.recommended_message;\r\n            opt.value = installment.installments;\r\n            document.getElementById(\"installments\").appendChild(opt);\r\n          });\r\n        } else {\r\n          alert(`installments method info error: ${response}`);\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  function doPay(e) {\r\n    e.preventDefault();\r\n    var $form = document.querySelector(\"#pay\");\r\n\r\n    window.Mercadopago.createToken($form, sdkResponseHandler);\r\n\r\n    return false;\r\n  }\r\n\r\n  function sdkResponseHandler(status, response) {\r\n    if (status !== 200 && status !== 201) {\r\n      alert(\"Dados Incorretos, Confira e Insira Novamente.\");\r\n      localStorage.setItem(\r\n        \"cartaoErro\",\r\n        \"O seu cartao nao foi aceite, nenhuma cobranca sera feita. Tente Novamente.\"\r\n      );\r\n      window.location.reload();\r\n    } else {\r\n      var form = document.querySelector(\"#pay\");\r\n      var card = document.createElement(\"input\");\r\n      card.setAttribute(\"name\", \"token\");\r\n      card.setAttribute(\"type\", \"hidden\");\r\n      card.setAttribute(\"value\", response.id);\r\n      form.appendChild(card);\r\n\r\n      window.doSubmit = true;\r\n\r\n      axios({\r\n        method: \"post\",\r\n        url: \"/pay\",\r\n        data: {\r\n          token: response.id,\r\n          transaction_amount: totalCarrinho(),\r\n          installments: document.getElementById(\"installments\").value,\r\n          payment_method_id: document.getElementById(\"payment_method_id\").value,\r\n          email: pedido.email,\r\n          description: pedido.dadosPedido\r\n        }\r\n      })\r\n        .then(function(response) {\r\n          const pag = {\r\n            id: response.data.response.id,\r\n            status: response.data.response.status\r\n          };\r\n          registoPedido(pag);\r\n        })\r\n        .catch(function(error) {\r\n          console.log(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  // Finalizar Pedido\r\n  const onSubmit = e => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    // updateDados(client);\r\n    doPay(e);\r\n  };\r\n\r\n  const registoPedido = pag => {\r\n    if (pag.status === \"rejected\") {\r\n      setAlert(\"O Seu Cartao nao Foi Aceite, Tente Novamente.\", \"danger\");\r\n      document.getElementById(\"cardNumber\").value = \"\";\r\n      document.getElementById(\"cardholderName\").value = \"\";\r\n      document.getElementById(\"cardExpirationMonth\").value = \"\";\r\n      document.getElementById(\"cardExpirationYear\").value = \"\";\r\n      document.getElementById(\"securityCode\").value = \"\";\r\n      document.getElementById(\"docNumber\").value = \"\";\r\n      // console.log(`Status: ${pag.status}`);\r\n      localStorage.setItem(\r\n        \"cartaoErro\",\r\n        \"O seu cartao nao foi aceite, nenhuma cobranca sera feita. Tente Novamente.\"\r\n      );\r\n      setTimeout(() => window.location.reload(), 6000);\r\n    } else {\r\n      addPedido({\r\n        numero_pedido: pag.id,\r\n        status_pagamento: pag.status,\r\n        produtos: pedido.dadosPedido,\r\n        valor: totalCarrinho(),\r\n        nome: pedido.nome,\r\n        endereco: pedido.endereco,\r\n        contato: pedido.telefone,\r\n        contato_email: pedido.email\r\n      });\r\n      setFinalizado({\r\n        numero_pedido: pag.id,\r\n        status_pagamento: pag.status,\r\n        produtos: pedido.dadosPedido,\r\n        valor: totalCarrinho(),\r\n        nome: pedido.nome,\r\n        endereco: pedido.endereco,\r\n        contato: pedido.telefone,\r\n        contato_email: pedido.email\r\n      });\r\n      localStorage.removeItem(\"cartaoErro\");\r\n      remAllCart();\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  const seguirCompra = () => {\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"pages-title\">\r\n          <h3>Pedido</h3>\r\n          <div className=\"line\"></div>\r\n        </div>\r\n        <div className=\"cart\">\r\n          {carrinho.map(i => (\r\n            <div className=\"cart-product first\" key={i.id}>\r\n              <div className=\"row\">\r\n                <div className=\"col s4\">\r\n                  <div className=\"contents\">\r\n                    <img src={i.img} alt=\"\" />\r\n                  </div>\r\n                </div>\r\n                <div className=\"col s6\">\r\n                  <div className=\"contents\">\r\n                    <strong>{i.nome}</strong>\r\n                  </div>\r\n                  <div className=\"contents\" style={{ marginTop: 20 }}>\r\n                    <strong>\r\n                      {\" \"}\r\n                      {i.valor * i.quantidade}\r\n                      {\".00\"}\r\n                    </strong>\r\n                  </div>\r\n                </div>\r\n                <div className=\"col s2\">\r\n                  <div className=\"contents remove\">\r\n                    <i\r\n                      className=\"fa fa-remove\"\r\n                      onClick={() =>\r\n                        remCart({\r\n                          id: i.id,\r\n                          nome: i.nome,\r\n                          valor: i.valor,\r\n                          img: i.img,\r\n                          desc: i.desc,\r\n                          quantidade: i.quantidade\r\n                        })\r\n                      }\r\n                    ></i>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"row\">\r\n                {/* <div className=\"col s4\">\r\n                    <div className=\"contents\">\r\n                      <p>Valor</p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col s8\" style={{ marginBottom: 5 }}>\r\n                    <div className=\"contents\">\r\n                      <p name=\"valor\" onChange={onChange}>\r\n                        {i.valor * i.quantidade}\r\n                        {\".00\"}\r\n                      </p>\r\n                    </div>\r\n                  </div> */}\r\n                <div className=\"col s4\">\r\n                  <div className=\"contents\">\r\n                    <p>Quantidade</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"col s8\">\r\n                  <div className=\"contents\">\r\n                    <button\r\n                      class=\"btn-floating btn-small scale-transition\"\r\n                      style={{ backgroundColor: \"#fce4ec\", marginRight: 5 }}\r\n                      onClick={() =>\r\n                        decreaseItem({\r\n                          id: i.id,\r\n                          nome: i.nome,\r\n                          desc: i.desc,\r\n                          img: i.img,\r\n                          valor: i.valor,\r\n                          quantidade: i.quantidade\r\n                        })\r\n                      }\r\n                    >\r\n                      <i class=\"material-icons\" style={{ color: \"#000\" }}>\r\n                        remove\r\n                      </i>\r\n                    </button>\r\n\r\n                    <input\r\n                      name=\"quantidade\"\r\n                      type=\"number\"\r\n                      readOnly\r\n                      style={{ width: 30, textAlign: \"center\" }}\r\n                      value={i.quantidade}\r\n                    ></input>\r\n                    <button\r\n                      class=\"btn-floating btn-small scale-transition\"\r\n                      style={{ backgroundColor: \"#fce4ec\", marginLeft: 5 }}\r\n                      onClick={() =>\r\n                        addItem({\r\n                          id: i.id,\r\n                          nome: i.nome,\r\n                          desc: i.desc,\r\n                          img: i.img,\r\n                          valor: i.valor,\r\n                          quantidade: i.quantidade\r\n                        })\r\n                      }\r\n                    >\r\n                      <i class=\"material-icons\" style={{ color: \"#000\" }}>\r\n                        add\r\n                      </i>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <div className=\"total-pay\">\r\n          {carrinho.map(i => (\r\n            <div className=\"row\" key={i.id}>\r\n              <div className=\"col s8\">\r\n                <div className=\"contents\">\r\n                  <p>{i.nome}</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"col s4\">\r\n                <div className=\"contents right\">\r\n                  <p>\r\n                    {i.valor * i.quantidade}\r\n                    {\".00\"}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n          <div className=\"col s8\" style={{ marginBottom: 10 }}>\r\n            <div className=\"contents\">\r\n              <h5>Total</h5>\r\n            </div>\r\n          </div>\r\n          <div className=\"col s4\">\r\n            <div className=\"contents right\">\r\n              <h5>\r\n                {totalCarrinho()}\r\n                {\".00\"}\r\n              </h5>\r\n            </div>\r\n          </div>\r\n          <br />\r\n          <br />\r\n        </div>\r\n        <form onSubmit={onSubmit} id=\"pay\" name=\"pay\">\r\n          <div className=\"pages-title\">\r\n            <h3>Dados para Entrega</h3>\r\n            <div className=\"line\"></div>\r\n          </div>\r\n          <div className=\"signup-contents\">\r\n            <label>Celular</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"telefone\"\r\n              value={client.telefone}\r\n              required\r\n              onChange={onChange}\r\n            />\r\n            <label>Rua</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"rua\"\r\n              value={client.rua}\r\n              required\r\n              onChange={onChange}\r\n            />\r\n            <label>Numero</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"numero\"\r\n              value={client.numero}\r\n              required\r\n              onChange={onChange}\r\n            />\r\n            <label>Complemento</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"complemento\"\r\n              value={client.complemento}\r\n              required\r\n              onChange={onChange}\r\n            />\r\n            <label>Bairro</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"numero\"\r\n              value={client.bairro}\r\n              required\r\n              onChange={onChange}\r\n            />\r\n            <label>Cidade</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"cidade\"\r\n              value={client.cidade}\r\n              required\r\n              onChange={onChange}\r\n            />\r\n            <label>Estado</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"numero\"\r\n              value={client.estado}\r\n              required\r\n              onChange={onChange}\r\n            />\r\n          </div>\r\n          <div className=\"pages-title\">\r\n            <h3>Pagamento</h3>\r\n            <div className=\"line\"></div>\r\n            <p>{localStorage.getItem(\"cartaoErro\")}</p>\r\n          </div>\r\n          <div className=\"signup-contents\">\r\n            <p>\r\n              <input\r\n                type=\"hidden\"\r\n                id=\"description\"\r\n                value={totalProdutos()}\r\n                onChange={onChange}\r\n              />\r\n            </p>\r\n            <p>\r\n              <input\r\n                id=\"transaction_amount\"\r\n                value={pedido.dadosPedido}\r\n                type=\"hidden\"\r\n                onChange={onChange}\r\n              />\r\n            </p>\r\n            <p>\r\n              <label htmlFor=\"cardNumber\">Número do cartão</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"cardNumber\"\r\n                data-checkout=\"cardNumber\"\r\n                onChange={onChange}\r\n                required\r\n              />\r\n            </p>\r\n            <p>\r\n              <label htmlFor=\"cardholderName\">Nome Igual ao Cartao</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"cardholderName\"\r\n                data-checkout=\"cardholderName\"\r\n                onChange={onChange}\r\n                required\r\n              />\r\n            </p>\r\n            <p>\r\n              <label htmlFor=\"cardExpirationMonth\">Mês de vencimento</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"cardExpirationMonth\"\r\n                data-checkout=\"cardExpirationMonth\"\r\n                onChange={onChange}\r\n                required\r\n              />\r\n            </p>\r\n            <p>\r\n              <label htmlFor=\"cardExpirationYear\">Ano de vencimento</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"cardExpirationYear\"\r\n                data-checkout=\"cardExpirationYear\"\r\n                onChange={onChange}\r\n                required\r\n              />\r\n            </p>\r\n            <p>\r\n              <label htmlFor=\"securityCode\">Código de segurança</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"securityCode\"\r\n                data-checkout=\"securityCode\"\r\n                onChange={onChange}\r\n                required\r\n              />\r\n            </p>\r\n            <p>\r\n              <select\r\n                type=\"hidden\"\r\n                id=\"installments\"\r\n                className=\"form-control\"\r\n                onChange={onChange}\r\n              ></select>\r\n            </p>\r\n            <p>\r\n              <select\r\n                id=\"docType\"\r\n                data-checkout=\"docType\"\r\n                type=\"hidden\"\r\n              ></select>\r\n            </p>\r\n            <p>\r\n              <label htmlFor=\"docNumber\">CPF</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"docNumber\"\r\n                data-checkout=\"docNumber\"\r\n                required\r\n              />\r\n            </p>\r\n            <p>\r\n              <input\r\n                type=\"hidden\"\r\n                id=\"email\"\r\n                value={pedido.email}\r\n                onChange={onChange}\r\n              />\r\n            </p>\r\n            <input type=\"hidden\" id=\"payment_method_id\" onChange={onChange} />\r\n            {!loading && (\r\n              <button type=\"submit\" className=\"btn\">\r\n                <i className=\"fa fa-send\"></i>Fazer Pedido\r\n              </button>\r\n            )}\r\n            {loading && <button className=\"button\">Aguarde...</button>}\r\n          </div>\r\n        </form>\r\n      </React.Fragment>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {finalizado && <Finalizado pedido={finalizado} />}\r\n      <div className=\"segments-page\">\r\n        <div className=\"container\">{carrinho.length > 0 && seguirCompra()}</div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default Carrinho;\r\n"]},"metadata":{},"sourceType":"module"}